# CVE-2024-47081

netrc credential leakage in the Python `requests` library â€” Proof of Concept for CVE-2024-47081.

> [!WARNING]  
> The vulnerability is not fixed in the latest version of `requests`. Be aware that using this code may expose sensitive information.

## Usage

```bash
uv sync
uv run main.py

uv run main.py --poc # to run the proof of concept
```

## Mitigations

- Set `trust_env` to `False` in your `requests` configuration.
```python
import requests
s = requests.session()
s.trust_env = False
s.get('https://example.com')
```


## References
- [request bug](https://github.com/psf/requests/blob/c65c780849563c891f35ffc98d3198b71011c012/src/requests/utils.py#L240-L245)
- [GitHub issue](https://github.com/psf/requests/issues/2773#issuecomment-177444662)
- [CVE-2024-47081](https://seclists.org/fulldisclosure/2025/Jun/2)
- [HackerNews discussion](https://news.ycombinator.com/item?id=44173193)

